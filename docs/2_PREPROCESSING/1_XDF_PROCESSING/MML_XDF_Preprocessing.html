<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mobile Multimodal Lab (MML): XDF Preprocessing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
        <div class="quarto-navbar-tools tools-end">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/MultiMobLab/Mobile-Multimodal-Lab">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/MultiMobLab/Mobile-Multimodal-Lab/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../2_PREPROCESSING/1_XDF_PROCESSING/MML_XDF_Preprocessing.html">Preprocessing</a></li><li class="breadcrumb-item"><a href="../../2_PREPROCESSING/1_XDF_PROCESSING/MML_XDF_Preprocessing.html">Mobile Multimodal Lab (MML): XDF Preprocessing</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Lab Setup</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">xxx</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">xxx</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Preprocessing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../2_PREPROCESSING/1_XDF_PROCESSING/MML_XDF_Preprocessing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Mobile Multimodal Lab (MML): XDF Preprocessing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Motion Tracking</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../3_MOTION_TRACKING/1_Video_Segmentation/Donders MML_Video Split.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Donderrs MML: Splitting Multiple Videos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../4b_SynchronyAnalyses/processing_and_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MMLAB PLOTS MULTIMODAL PLOT BONANZA</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../5_ANIMATIONS/Donders_MML_Multimodal_Animations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DONDERS MML: Multimodal Animations</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../2_PREPROCESSING/1_XDF_PROCESSING/MML_XDF_Preprocessing.html">Preprocessing</a></li><li class="breadcrumb-item"><a href="../../2_PREPROCESSING/1_XDF_PROCESSING/MML_XDF_Preprocessing.html">Mobile Multimodal Lab (MML): XDF Preprocessing</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Mobile Multimodal Lab (MML): XDF Preprocessing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MML_XDF_Preprocessing_files/figure-html/b2f4587d-1-dc660b39-b1c5-41cc-b996-3d46c637f152.png" class="img-fluid figure-img"></p>
<figcaption>Donders MML LOGO.png</figcaption>
</figure>
</div>
<section id="info-documents" class="level3">
<h3 class="anchored" data-anchor-id="info-documents">Info Documents</h3>
<p>Github Repository Jupyter Notebook Quarto Book</p>
</section>
<section id="requirements" class="level3">
<h3 class="anchored" data-anchor-id="requirements">Requirements</h3>
<p>Please install the necessary packages in requirements.txt using pip install -r requirements.txt</p>
</section>
<section id="code-overview" class="level3">
<h3 class="anchored" data-anchor-id="code-overview">CODE OVERVIEW</h3>
<p>A preprocessing pipeline for handling multimodal .xdf files collected with MML. This script is designed to process XDF files, extract data streams, perform renaming and clipping operations, and save the processed data in CSV and WAV formats, with built-in GUI prompts for stream segmentation.</p>
<hr>
<p><strong>Packages</strong><br>
This section imports all the necessary libraries and modules used throughout the script. These include modules for file handling, data manipulation, audio processing, video processing, plotting, and GUI interaction.<br>
See <code>requirements.txt</code> for all necessary packages (<code>pip install -r requirements.txt</code>).</p>
<hr>
<p><strong>Key Variables</strong> - <code>input_folder</code>: directory where raw <code>.xdf</code> files are stored<br>
- <code>output_folder</code>: where all processed data streams will be saved<br>
- <code>noise_reducelevel</code>: sets the level for noise reduction in audio processing<br>
- <code>extension_to_codec = { ... }</code>: maps different file extensions to their corresponding codecs for video processing<br>
- <code>rename_dict = { ... }</code>: this dictionary is used to rename certain data streams based on their name and type<br>
<strong>!! this dictionary should be adjusted or removed according to the user xdf file</strong></p>
<hr>
<p><strong>Functions</strong> - <code>to_audio</code>: converts time-series data from e.g., Microphone into a WAV audio file<br>
- <code>rename_streams</code>: renames streams based on the provided dictionary (<code>rename_dict</code>)<br>
- <code>find_start_end_times</code>: launches a GUI to define clipping intervals. Supports: - latest common time window across non-marker streams - manual start and end input - marker-defined intervals (single or multiple event pairs) - <code>get_events</code>: returns the LSL timestamps of specific events in a marker stream</p>
<hr>
<p><strong>Identifying XDF Files</strong> - <strong>Method 1</strong>: Automatically identifying XDF files in the input directory and its subdirectories by traversing the input directory to find all files with the <code>.xdf</code> extension and adding them to the <code>xdf_files</code> list<br>
- <strong>Method 2</strong>: Manually selecting XDF files using a GUI dialog. Provides an alternative way to manually select XDF files using a graphical file selection dialog.</p>
<hr>
<p><strong>Main Loop</strong><br>
For each <code>.xdf</code> file: 1. The file is loaded using <code>pyxdf.load_xdf</code><br>
2. Streams are renamed (if applicable)<br>
3. The user selects clipping times using the GUI (<code>find_start_end_times</code>)<br>
4. Each stream is processed: - Metadata is extracted (name, sample rate, channels) - The stream is clipped to the defined time interval - A CSV file is saved with timestamps and data - If the stream is from a microphone: - A WAV file is created - A denoised version of the WAV is also saved using <code>noisereduce</code></p>
<p>Each streamâ€™s data is saved to a subfolder structured by file name and clipping method (e.g., <code>data_processed/ParticipantX/manual_startend/</code>).</p>
<hr>
</section>
<section id="notes" class="level3">
<h3 class="anchored" data-anchor-id="notes">Notes</h3>
<ul>
<li>This script assumes all <code>.xdf</code> files are synchronized via LSL (set <code>synchronize_clocks=True</code> during loading)</li>
<li>The GUI interactions (based on <code>tkinter</code>) require a desktop Python environment</li>
<li>Make sure your stream names/types match those in the <code>rename_dict</code> if you use it</li>
<li>Output folders and filenames are automatically generated based on stream metadata</li>
</ul>
</section>
<section id="output" class="level3">
<h3 class="anchored" data-anchor-id="output">Output</h3>
<p>For each input <code>.xdf</code>, you will get: - Clipped CSV files for each stream - WAV and denoised WAV files for microphone data - Folder structure organized by participant and method</p>
<hr>
<section id="author-davide-ahmar" class="level4">
<h4 class="anchored" data-anchor-id="author-davide-ahmar">Author: Davide Ahmar</h4>
</section>
<section id="last-modified-13052025-by-davide-ahmar" class="level4">
<h4 class="anchored" data-anchor-id="last-modified-13052025-by-davide-ahmar">Last Modified: 13/05/2025 by Davide Ahmar</h4>
</section>
</section>
<section id="import-all-the-necessary-packages-to-work-with-xdf-audio-and-video-files" class="level2">
<h2 class="anchored" data-anchor-id="import-all-the-necessary-packages-to-work-with-xdf-audio-and-video-files">0. Import all the necessary packages to work with XDF, Audio and Video files</h2>
<div id="8f88e2cd" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os             <span class="co"># Importing the os module which provides functions for interacting with the operating system</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pyxdf          <span class="co"># Importing pyxdf, a Python library for reading XDF files</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob           <span class="co"># Importing the glob module which helps in finding files/directories with specific patterns</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd   <span class="co"># Importing pandas library (abbreviated as pd), which is used for data manipulation and analysis</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np    <span class="co"># Importing numpy library (abbreviated as np), which is used for numerical computations</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wave           <span class="co"># Importing wave module for reading and writing WAV files (usually audio files) </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> struct         <span class="co"># Importing struct module which provides functions to convert between Python values and C structs</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math           <span class="co"># Importing math module which provides mathematical functions</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random         <span class="co"># Importing random module for generating random numbers</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.io <span class="im">import</span> wavfile  <span class="co"># Importing wavfile module from scipy.io (a library built on numpy), for reading and writing WAV files</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> noisereduce <span class="im">as</span> nr      <span class="co"># Importing noisereduce module for noise reduction in audio signals</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json            <span class="co"># Importing json module for working with JSON data</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2            <span class="co"># Importing OpenCV library for computer vision tasks</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> moviepy.editor <span class="im">import</span> (                <span class="co"># Importing various classes and functions from moviepy.editor module</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                            VideoFileClip,  <span class="co"># Class for working with video files</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                            AudioFileClip,  <span class="co"># Class for working with audio files</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                            CompositeAudioClip)  <span class="co"># Class for composing audio clip</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> moviepy.video.io.VideoFileClip <span class="im">import</span> VideoFileClip</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> moviepy.video.io.ffmpeg_tools <span class="im">import</span> ffmpeg_extract_subclip  <span class="co"># video  clipping fucntion </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> moviepy.video.io.VideoFileClip <span class="im">import</span> VideoFileClip          <span class="co"># alternative video clipping function</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt                                   <span class="co"># Importing pyplot library to create figures and plot data </span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.widgets <span class="im">import</span> Slider  </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter   <span class="im">as</span> tk                                                 <span class="co"># GUI toolkit </span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> (filedialog, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                     simpledialog, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                     Listbox, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                     StringVar, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                     messagebox)                         <span class="co"># GUI toolkit </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Everything was imported succesfully"</span>) <span class="co">#as terminal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Everything was imported succesfully</code></pre>
</div>
</div>
</section>
<section id="define-the-relevant-paths-variables-functions" class="level2">
<h2 class="anchored" data-anchor-id="define-the-relevant-paths-variables-functions">1. Define the Relevant Paths, Variables &amp; Functions</h2>
<div id="ecb3769c" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ PATHS -----------------------------------------------------</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>input_folder <span class="op">=</span> <span class="st">'./data_raw/'</span>  <span class="co"># input folder with the raw XDF files (relative path) </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>output_folder <span class="op">=</span> <span class="st">'./data_processed/'</span>  <span class="co"># output folder where the raw extracted data will be saved (relative path) </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Input folder ="</span>, os.path.abspath(input_folder))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Output folder ="</span>, os.path.abspath(output_folder))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------ VARIABLES ----------------------------------------------</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>noise_reducelevel <span class="op">=</span> <span class="fl">1.5</span>  <span class="co">#This can be changed accordingly </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary to map file extensions to codecs</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>extension_to_codec <span class="op">=</span> {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.mp4'</span>: <span class="st">'libx264'</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.avi'</span>: <span class="st">'libxvid'</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.mov'</span>: <span class="st">'libx264'</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.mkv'</span>: <span class="st">'libx264'</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.flv'</span>: <span class="st">'flv'</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add more mappings as needed</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># IF NEEDED: Create a dictionary mapping from old stream names to new stream names (# Edit and add more mappings as needed.) </span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>     <span class="co"># (This dictionary mapping is based both of the stream_names and stream_types because in our case we have 2 streams with the same name (but different types)) </span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'MyWebcamFrameStream_1'</span>, <span class="st">'frameNR'</span>): <span class="st">'Video_P1'</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'MyWebcamFrameStream_2'</span>, <span class="st">'frameNR'</span>): <span class="st">'Video_P2'</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Mic'</span>, <span class="st">'voice'</span>): <span class="st">'Mic_P1'</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Mic_004'</span>, <span class="st">'voice'</span>): <span class="st">'Mic_P2'</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'OpenSignals'</span>, <span class="st">'00:07:80:8C:06:6A'</span>): <span class="st">'PLUX_P2'</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'OpenSignals'</span>, <span class="st">'00:07:80:D8:A8:81'</span>): <span class="st">'PLUX_P1'</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------FUNCTIONS------------------------------------------------------------------------------------</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># AUDIO: Creating a function named "to_audio" tht writes audio data (input) and transforms into a WAV file (output). </span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> to_audio(fileloc, timeseries_name, timeseries, samplerate <span class="op">=</span> <span class="dv">16000</span>, channels <span class="op">=</span> <span class="dv">1</span>):   </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co">    This function - named "to_audio" - writes audio data to a WAV file.</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co">    It accepts the following parameters:</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">    - fileloc (str): Location to save the audio file.</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">    - timeserie_name: Name of the timeseries stream to be converted to audio.</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">    - timeseries (list): List of audio data points to be written to the audio file.</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co">    - samplerate (int, optional): Sampling rate of the audio data. Defaults to 16000.</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co">    - channels (int, optional): Number of audio channels (mono or stereo). Defaults to 1 (mono)</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'Mic'</span> <span class="kw">in</span> timeseries_name:  <span class="co">#Condition check that the timeseriestype belongs to the microphone.</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        obj <span class="op">=</span> wave.<span class="bu">open</span>(fileloc,<span class="st">'w'</span>)        <span class="co"># Opens audio file using the wave.open() function write mode ('w'). Assigns data it to the variable obj.</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        obj.setnchannels(channels)          <span class="co"># Sets the number of channels in the audio file using obj.setnchannels(channels). Deafault 1 channel (mono).</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        obj.setsampwidth(<span class="dv">2</span>)                 <span class="co"># Sets the sample width in bytes using obj.setsampwidth(2). The value '2' indicates 16-bit audio.</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        obj.setframerate(<span class="bu">float</span>(samplerate)) <span class="co"># sets the frame rate of the audio file using obj.setframerate(float(samplerate)), where samplerate is provided as a parameter.</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> timeseries:                      <span class="co"># Loop to iterate over each time-point in the temeseries stream</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> struct.pack(<span class="st">'&lt;h'</span>, <span class="bu">int</span>(i[<span class="dv">0</span>]))   <span class="co"># Converts the first value of the timeseries to an integer and packs it into a binary string (struck.pack()) according to the '&lt;h' fromat (i.e., short integer (16 bits) in little-endian byte order)   </span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            obj.writeframesraw( data )            <span class="co"># Writes the packed binary data into an audio file using the wave function writeframesraw() from the wave library </span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        obj.close()                               <span class="co"># Closes the audio file </span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Function </span><span class="ch">\"</span><span class="st">to_audio</span><span class="ch">\"</span><span class="st"> created sucesfully"</span>) </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming XDF Stream (if necessary)</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rename_streams(streams, rename_dict):</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="co">    Function rename_stream renames any streams based on the rename dictionary (if name found in remane_dict)</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="co">        Parameters:</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="co">    stream_name (str): The current name of the stream.</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="co">    stream_type (str): The type of the stream.</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="co">    rename_dict (dict): A dictionary mapping old stream names and types to new stream names.</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="co">    str: The new stream name if found in rename_dict, otherwise the original stream name.</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> stream <span class="kw">in</span> streams:</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        stream_name <span class="op">=</span> stream[<span class="st">'info'</span>][<span class="st">'name'</span>][<span class="dv">0</span>]</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        stream_type <span class="op">=</span> stream[<span class="st">'info'</span>][<span class="st">'type'</span>][<span class="dv">0</span>]</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (stream_name, stream_type) <span class="kw">in</span> rename_dict:</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>            new_name <span class="op">=</span> rename_dict[(stream_name, stream_type)]</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f'Renaming stream </span><span class="sc">{</span>stream_name<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>stream_type<span class="sc">}</span><span class="ss">) to </span><span class="sc">{</span>new_name<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>            stream[<span class="st">'info'</span>][<span class="st">'name'</span>][<span class="dv">0</span>] <span class="op">=</span> new_name  <span class="co"># Rename the stream</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> streams</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Function </span><span class="ch">\"</span><span class="st">rename_streams</span><span class="ch">\"</span><span class="st"> created sucesfully"</span>) </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to find the START and </span><span class="re">END</span><span class="co"> times for all streams in XDF file </span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_start_end_times(streams):  </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="co">    Function to find START and </span><span class="re">END</span><span class="co"> (LSL) times based on user input using a GUI window. </span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="co">     The function offers two primary methods for selecting start and end times:</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="co">       1. **NOT based on Marker Events**: </span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="co">        - Option 1: Automatically selects the latest start time and the earliest end time among all non-marker streams.</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="co">        - Option 2: Allows the user to manually input specific start and end times.</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="co">        2. **Based on Marker Events**:</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a><span class="co">        - Option 1: Allows the user to specify a single pair of start and end events, using the markers in the data to determine times.</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="co">        - Option 2: Allows the user to specify multiple pairs of start and end events, using markers in the data to determine times.</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="co">        XDF streams: list of streams to be clipped based on user-selected start and end events or time bounds. Each stream is a dictionary </span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="co">                        containing information about the stream, including type, name, time stamps, and time series.</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a><span class="co">    Output: </span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="co">       -  `time_pairs`: A dictionary where the keys are tuples of the form `(start_event, end_event)` (or `(start_marker, end_marker)`), </span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a><span class="co">      and the values are tuples of the form `(start_time, end_time)`, representing the selected LSL times for extraction.</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="co">       -  `method`: A string indicating the method used. It can be one of the following:</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="co">                - 'lateststart_earliestend'</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="co">                - 'manual_startend'</span></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="co">                - 'marker_ONEpair'</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="co">                - 'marker_MULTIPLEpairs'</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="co">       </span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="co">        Notes:</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a><span class="co">        - Ensure that the streams list contains at least one Marker stream if using the marker-based method.</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="co">        - The function relies on `tkinter.simpledialog` for user interaction, so it must be run in an environment that </span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="co">          supports GUI windows.</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="co">          </span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="co">        Example Usage:</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="co">        start_end_times, method = find_start_end_times(streams)</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the main application window</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tk.Tk()</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>    root.withdraw()  <span class="co"># Hide the main window</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ask user for START and </span><span class="re">END</span><span class="co"> times method with a GUI prompt</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>    choice <span class="op">=</span> simpledialog.askstring(<span class="st">"Clipping Method"</span>, </span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Choose the START &amp; END of your streams:</span><span class="ch">\n</span><span class="st">1. NOT based on Marker Events</span><span class="ch">\n</span><span class="st">2. Based on Marker Events"</span>)</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the time_pairs dictionary to store the selected start and end times</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>    time_pairs <span class="op">=</span> {}</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the user chooses to select the start and end time NOT based on Marker Events</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> choice <span class="op">==</span> <span class="st">'1'</span>:</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>        choice_1 <span class="op">=</span> simpledialog.askstring(<span class="st">"Method NOT based on Marker Event "</span>, </span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Choose one option:</span><span class="ch">\n</span><span class="st">1. Latest START time (for all streams except Marker) &amp; Earliest END time (for all streams except Marker) </span><span class="ch">\n</span><span class="st">2. Manual selection of START and END times"</span>)</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> choice_1 <span class="op">==</span> <span class="st">'1'</span>:  <span class="co"># Find the latest start time across all streams except Marker streams</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>            method <span class="op">=</span> <span class="st">'lateststart_earliestend'</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Method: '</span> <span class="op">+</span> method)</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Filter out marker streams for calculating the latest start and earliest end times</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>            non_marker_streams <span class="op">=</span> [stream <span class="cf">for</span> stream <span class="kw">in</span> streams <span class="cf">if</span> stream[<span class="st">'info'</span>][<span class="st">'type'</span>][<span class="dv">0</span>] <span class="op">!=</span> <span class="st">'Markers'</span>]</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> non_marker_streams:</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                name_i <span class="op">=</span> i[<span class="st">'info'</span>][<span class="st">'name'</span>][<span class="dv">0</span>]</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="bu">str</span>(name_i))</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find the latest start time across all non-marker streams</span></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>            begintimes <span class="op">=</span> [stream[<span class="st">'time_stamps'</span>][<span class="dv">0</span>] <span class="cf">for</span> stream <span class="kw">in</span> non_marker_streams]</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>            latest_start_time <span class="op">=</span> <span class="bu">max</span>(begintimes)  <span class="co"># Get the first timestamp of each non-marker stream and find the maximum (latest start time)</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find the earliest end time across all non-marker streams</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>            endtimes <span class="op">=</span> [stream[<span class="st">'time_stamps'</span>][<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> stream <span class="kw">in</span> non_marker_streams]</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>            earliest_end_time <span class="op">=</span> <span class="bu">min</span>(endtimes)  <span class="co"># Get the last timestamp of each non-marker stream and find the minimum (earliest end time)</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Create a dictionary with the start and end times stored as tuples</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>            time_pairs <span class="op">=</span> {(<span class="st">'latest_start'</span>, <span class="st">'earliest_end'</span>): (latest_start_time, earliest_end_time)}</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Selected START &amp; END Time Pairs : </span><span class="sc">{</span>time_pairs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> choice_1 <span class="op">==</span> <span class="st">'2'</span>:  <span class="co"># Manual selection of the start and end times</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>            method <span class="op">=</span> <span class="st">'manual_startend'</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Method: '</span> <span class="op">+</span> method)</span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Show the user the Start and end times of all streams </span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> stream <span class="kw">in</span> streams:  </span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"Stream: </span><span class="sc">{</span>stream[<span class="st">'info'</span>][<span class="st">'name'</span>][<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"Start time: </span><span class="sc">{</span>stream[<span class="st">'time_stamps'</span>][<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"End time: </span><span class="sc">{</span>stream[<span class="st">'time_stamps'</span>][<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>            start_time <span class="op">=</span> simpledialog.askfloat(<span class="st">"Manual Selection"</span>, </span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"Enter the START time in seconds (consider printed start times for all streams for boundaries)"</span>)</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>            end_time <span class="op">=</span> simpledialog.askfloat(<span class="st">"Manual Selection"</span>, </span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"Enter the END time in seconds (consider printed end times for all streams for boundaries)"</span>)</span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>            <span class="co"># creating a dictionary with the start and end times stored as tuples</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> start_time <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> end_time <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>                time_pairs <span class="op">=</span> {(<span class="st">'manual_start'</span>, <span class="st">'manual_end'</span>): (start_time, end_time)}</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"Selected START &amp; END Time Pairs : </span><span class="sc">{</span>time_pairs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">'2'</span>: </span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Identify a Marker stream </span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>        marker_stream <span class="op">=</span> [stream <span class="cf">for</span> stream <span class="kw">in</span> streams <span class="cf">if</span> stream[<span class="st">'info'</span>][<span class="st">'type'</span>][<span class="dv">0</span>] <span class="op">==</span> <span class="st">'Markers'</span>][<span class="dv">0</span>]</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Marker stream: "</span>)</span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(marker_stream[<span class="st">'time_series'</span>])):</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="bu">str</span>(marker_stream[<span class="st">'time_series'</span>][i]).replace(<span class="st">'['</span>, <span class="st">''</span>).replace(<span class="st">']'</span>, <span class="st">''</span>).replace(<span class="st">"'"</span>, <span class="st">""</span>))   <span class="co">## Print all the events in the marker stream in an organized way</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>        choice_2 <span class="op">=</span> simpledialog.askstring(<span class="st">"Method Based on Marker Event "</span>, </span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Choose one option:</span><span class="ch">\n</span><span class="st">1. Only 1 START &amp; 1 END Events </span><span class="ch">\n</span><span class="st">2. MULTIPLE START &amp; END Events"</span>)</span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> choice_2 <span class="op">==</span> <span class="st">'1'</span>: </span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>            method <span class="op">=</span> <span class="st">'marker_ONEpair'</span></span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Method: '</span> <span class="op">+</span> method)</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>            start_event <span class="op">=</span> simpledialog.askstring(<span class="st">"SINGLE PAIR Marker Event"</span>, </span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"Enter the START event name (you can copy and paste the event name from the terminal)"</span>)</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>            end_event <span class="op">=</span> simpledialog.askstring(<span class="st">"SINGLE PAIR Marker Event"</span>, </span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"Enter the END event name (you can copy and paste the event name from the terminal)"</span>)</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Selected START Event: </span><span class="sc">{</span>start_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Selected END Event: </span><span class="sc">{</span>end_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find the corresponding LSL times in the Marker stream based on start_event and end_event</span></span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>            start_time <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>            end_time <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> idx, event <span class="kw">in</span> <span class="bu">enumerate</span>(marker_stream[<span class="st">'time_series'</span>]):  <span class="co"># enumerate the events (i.e., 'time_series in XDF stream') in the marker stream</span></span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> event[<span class="dv">0</span>] <span class="op">==</span> start_event.strip():</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>                    start_time <span class="op">=</span> marker_stream[<span class="st">'time_stamps'</span>][idx]  <span class="co"># Find the corresponding LSL time in the Marker stream based on start_event</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> event[<span class="dv">0</span>] <span class="op">==</span> end_event.strip():</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>                    end_time <span class="op">=</span> marker_stream[<span class="st">'time_stamps'</span>][idx]  <span class="co"># Find the corresponding LSL time in the Marker stream based on end_event</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> start_time <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> end_time <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"Could not find both events: </span><span class="sc">{</span>start_event<span class="sc">}</span><span class="ss"> or </span><span class="sc">{</span>end_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>            <span class="co"># create a dictionary with the start and end events and the corresponding start and end times stored as tuples</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>            time_pairs <span class="op">=</span> {(start_event.strip(), end_event.strip()): (start_time, end_time)}   </span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Selected START &amp; END Time Pairs : </span><span class="sc">{</span>time_pairs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> choice_2 <span class="op">==</span> <span class="st">'2'</span>:</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>            method <span class="op">=</span> <span class="st">'marker_MULTIPLEpairs'</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Method: '</span> <span class="op">+</span> method)</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>            event_list <span class="op">=</span> simpledialog.askstring(<span class="st">"MULTIPLE PAIRS Marker Event"</span>,</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"Enter each PAIR of START and END events SEQUENTIALLY (you can copy and paste the event name from the terminal). "</span></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"Follow the format exactly: START1:END1, START2:END2, START3:END3, etc."</span>) </span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Convert the event_list into a list of tuples</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> event_list:</span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># First, split by commas to get each pair, and ensure no extra spaces</span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>                    event_pairs <span class="op">=</span> [pair.split(<span class="st">':'</span>) <span class="cf">for</span> pair <span class="kw">in</span> event_list.replace(<span class="st">" "</span>, <span class="st">""</span>).split(<span class="st">','</span>)]</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Ensure that each pair contains exactly two elements (start and end)</span></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> pair <span class="kw">in</span> event_pairs:</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">len</span>(pair) <span class="op">!=</span> <span class="dv">2</span>:</span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"Invalid format for pair: </span><span class="sc">{</span>pair<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"Error in the provided input: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>                    event_pairs <span class="op">=</span> []</span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"Selected START &amp; END Event Pairs: </span><span class="sc">{</span>event_pairs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find the corresponding LSL times in the Marker stream based on the event_pairs and store them in a dictionary</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>            time_pairs <span class="op">=</span> {}  <span class="co"># Initialize an empty dictionary to store the time pairs</span></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> start_event, end_event <span class="kw">in</span> event_pairs:  <span class="co"># Iterate over each pair to extract corresponding start and end times</span></span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>                start_time <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>                end_time <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> idx, event <span class="kw">in</span> <span class="bu">enumerate</span>(marker_stream[<span class="st">'time_series'</span>]):</span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> event[<span class="dv">0</span>] <span class="op">==</span> start_event.strip():</span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>                        start_time <span class="op">=</span> marker_stream[<span class="st">'time_stamps'</span>][idx]</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> event[<span class="dv">0</span>] <span class="op">==</span> end_event.strip():</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>                        end_time <span class="op">=</span> marker_stream[<span class="st">'time_stamps'</span>][idx]</span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If both times are found, add them to the dictionary</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> start_time <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> end_time <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>                   time_pairs[(start_event.strip(), end_event.strip())] <span class="op">=</span> (start_time, end_time)    <span class="co"># Store the events and correspdonding times as a tuple in the dictionary</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"Could not find both events: </span><span class="sc">{</span>start_event<span class="sc">}</span><span class="ss"> or </span><span class="sc">{</span>end_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Selected START &amp; END Time Pairs : </span><span class="sc">{</span>time_pairs<span class="sc">}</span><span class="ss">"</span>)  </span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time_pairs, method</span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Function </span><span class="ch">\"</span><span class="st">find_start_end_times</span><span class="ch">\"</span><span class="st"> created sucesfully"</span>)</span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to extract specified events (with correspodning LSL times) from XDF stream (useful for plotting)</span></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_events(stream, event_names):</span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a><span class="co">    Extracts events and corresponding LSL times from the given stream that match any of the event_names.</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a><span class="co">    stream (dict): The stream containing time stamps and event data.</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a><span class="co">    event_names (list of str): List of event name substrings to look for in the events.</span></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a><span class="co">    np.array: An array where each row contains a timestamp and the full event name.</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    events <span class="op">=</span> []  <span class="co"># Initialize an empty list to store matching events</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the stream type is "Markers"</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> stream[<span class="st">'info'</span>][<span class="st">'type'</span>][<span class="dv">0</span>] <span class="op">!=</span> <span class="st">"Markers"</span>:</span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"ERROR: The stream provided (</span><span class="sc">{</span>stream[<span class="st">'info'</span>][<span class="st">'name'</span>][<span class="dv">0</span>]<span class="sc">}</span><span class="ss">) is not a Marker stream"</span>)</span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over the time stamps and corresponding events in the stream</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> timestamp, event <span class="kw">in</span> <span class="bu">zip</span>(stream[<span class="st">'time_stamps'</span>], stream[<span class="st">'time_series'</span>]):</span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if any of the specified event names are in the current event</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> name <span class="kw">in</span> event_names:</span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> name <span class="kw">in</span> event[<span class="dv">0</span>]:</span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If a match is found, append the timestamp and full event name to the list</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>                events.append([timestamp, event[<span class="dv">0</span>]])</span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the list of events to a NumPy array and return it</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(events)</span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Function </span><span class="ch">\"</span><span class="st">get_events</span><span class="ch">\"</span><span class="st"> created sucesfully"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input folder = f:\Mobile-Multimodal-Lab\2_PREPROCESSING\1_XDF_PROCESSING\data_raw
Output folder = f:\Mobile-Multimodal-Lab\2_PREPROCESSING\1_XDF_PROCESSING\data_processed
Function "to_audio" created sucesfully
Function "rename_streams" created sucesfully
Function "find_start_end_times" created sucesfully
Function "get_events" created sucesfully</code></pre>
</div>
</div>
</section>
<section id="identifying-xdf-files-in-input-folder-or-any-subfolder" class="level2">
<h2 class="anchored" data-anchor-id="identifying-xdf-files-in-input-folder-or-any-subfolder">2. Identifying XDF files in Input Folder or any Subfolder</h2>
<div id="a9fd9537" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>xdf_files <span class="op">=</span> []  <span class="co"># Initialize an empty list to store paths of XDF files</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Traverse through the directory and its subdirectories to find XDF files</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> root, dirs, files <span class="kw">in</span> os.walk(input_folder):  <span class="co"># 1st loop iterating over the results returned by os.walk().</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:                                    <span class="co"># 2nd loop iterating through each file in the current directory</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">file</span>.endswith(<span class="st">".xdf"</span>):                         <span class="co"># checking if the file has and XDF extension </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>             xdf_files.append(os.path.join(root, <span class="bu">file</span>))   <span class="co"># if the file is an XDF file, append its full path to the xdf_files list</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'We have idenified the following XDF files: '</span> <span class="op">+</span> <span class="bu">str</span>(xdf_files))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We have idenified the following XDF files: ['./data_raw/pilot_ming_02.xdf', './data_raw/T1_experiment.xdf']</code></pre>
</div>
</div>
</section>
<section id="a.-alternatively-the-user-can-select-their-own-xdf-file" class="level2">
<h2 class="anchored" data-anchor-id="a.-alternatively-the-user-can-select-their-own-xdf-file">2a. Alternatively, the user can select their own XDF file</h2>
<div id="1b4f83bf-1184-46c1-941f-accfe5dfbd91" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tkinter <span class="co"># GUI toolkit to open and save files</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tkinter <span class="im">import</span> filedialog <span class="co"># GUI toolkit to open and save files</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> tkinter.Tk()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>root.attributes(<span class="st">'-topmost'</span>,<span class="va">True</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>root.iconify()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>xdf_files <span class="op">=</span> filedialog.askopenfilename(title<span class="op">=</span><span class="st">"Select an XDF file"</span>, filetypes<span class="op">=</span>[(<span class="st">"XDF Files"</span>, <span class="st">"*.xdf"</span>)], multiple <span class="op">=</span> <span class="st">'True'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>root.destroy()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the tuple returned by askopenfilenames() to a list</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>xdf_files <span class="op">=</span> <span class="bu">list</span>(xdf_files)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'You have selected the following XDF files: '</span> <span class="op">+</span> <span class="bu">str</span>(xdf_files))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>You have selected the following XDF files: ['F:/Mobile-Multimodal-Lab/2_PREPROCESSING/XDF_PROCESSING/data_raw/T1_experiment.xdf']</code></pre>
</div>
</div>
</section>
<section id="main-loop-that-i-extracts-ii-renames-and-iii-clips-each-data-stream-from-each-xdf-and-saves-them-as-cvs-or-wav-files" class="level1">
<h1>3. Main Loop that (i) Extracts (ii) Renames and (iii) Clips each data stream from each XDF and saves them as CVS or WAV files</h1>
<div id="6df87847-8651-4e9e-a681-a48534cdd25b" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>output_folder <span class="op">=</span> <span class="st">'./data_processed/'</span>  <span class="co"># output_folder for the CVS and WAV files </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Output folder ="</span>, os.path.abspath(output_folder))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> xdf_file <span class="kw">in</span> xdf_files:               <span class="co"># Iterate over each path in the list "xdf_files". </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'loading xdf file: '</span> <span class="op">+</span> xdf_file )</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    streams, header <span class="op">=</span> pyxdf.load_xdf(xdf_file)    <span class="co"># Loading steams and header information from each XDF file usign the load_xdf function from the pyxdf library. </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    fnam <span class="op">=</span> os.path.basename(xdf_file)[:<span class="op">-</span><span class="dv">4</span>]        <span class="co"># Extract the file name from the path and assings it to fnam, whilst removing the '.xdf' extension (i.e., the last 4 characters in the string)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Renaming streams using the rename_dict and rename_function (if names match dictionary)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Renaming streams based on the dictionary mapping'</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    streams <span class="op">=</span> rename_streams(streams, rename_dict)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Finding the start and end times for all streams in the XDF file</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Finding the start and end times for all streams in the XDF file'</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    start_end_times, method <span class="op">=</span> find_start_end_times(streams)  <span class="co"># Call the find_start_end_times function to find the start and end times for all streams in the XDF file.</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Navigating through each stream and extracting the relevant information (e.g., name, sample rate, data, time, etc.) </span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> stream <span class="kw">in</span> streams:                        <span class="co"># Iterate over each steam in the loaded steam for each XDF file .</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        timeseries_name <span class="op">=</span> stream[<span class="st">'info'</span>][<span class="st">'name'</span>][<span class="dv">0</span>]                    <span class="co"># Extracts name of each steams (dictionary structure) and assigns it to timeseries_name (e.g., Mic). </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        timeseries_type <span class="op">=</span> stream[<span class="st">'info'</span>][<span class="st">'type'</span>][<span class="dv">0</span>]</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        timevec         <span class="op">=</span> stream[<span class="st">'time_stamps'</span>]                                <span class="co"># Extract the time_stamps (i.e.,LSL TIMESTAMPS) from the "stream" dictionary and assigns it to the variable timevec</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        timeseries      <span class="op">=</span> stream[<span class="st">'time_series'</span>]                                <span class="co"># Extract the time_series (i.e., DATA) from the "stream" dictionary and </span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        samplerate      <span class="op">=</span> <span class="bu">round</span>(<span class="bu">float</span>(stream[<span class="st">'info'</span>][<span class="st">'nominal_srate'</span>][<span class="dv">0</span>]))     <span class="co"># Extracts the rounded sampling rate (nominal_srate) and assings it to samplerate </span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        channelcount    <span class="op">=</span> <span class="bu">int</span>(stream[<span class="st">'info'</span>][<span class="st">'channel_count'</span>][<span class="dv">0</span>])              <span class="co"># Extracts the number of channel for each steams and assigns it to channelcount (as an integer)</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract channel labels (this step is a bit more complex because of the XDF file configuration)</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        channel_labels <span class="op">=</span> []  <span class="co"># Initialize an empty list to store channel labels</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if there is more than one channel and if the 'desc' field is present in the stream's info</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> channelcount <span class="op">&gt;</span> <span class="dv">1</span> <span class="kw">and</span> stream[<span class="st">'info'</span>][<span class="st">'desc'</span>] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                channels_info <span class="op">=</span> stream[<span class="st">'info'</span>][<span class="st">'desc'</span>][<span class="dv">0</span>][<span class="st">'channels'</span>][<span class="dv">0</span>][<span class="st">'channel'</span>]  <span class="co"># Attempt to extract channel information from the stream's description</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>                channel_labels <span class="op">=</span> [channel[<span class="st">'label'</span>][<span class="dv">0</span>] <span class="cf">for</span> channel <span class="kw">in</span> channels_info]  <span class="co"># Create a list of channel labels by extracting the 'label' field from each channel's info</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> (<span class="pp">KeyError</span>, <span class="pp">IndexError</span>):</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>                channel_labels <span class="op">=</span> [<span class="ss">f"Channel </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(channelcount)]  <span class="co"># If there is any issue with extracting channel labels, create default labels</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>            channel_labels <span class="op">=</span> [<span class="ss">f"Channel </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(channelcount)]  <span class="co"># If there is only one channel or the 'desc' field is not present, create default labels</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'working on stream: '</span> <span class="op">+</span> timeseries_name <span class="op">+</span> <span class="st">'  with a channel count of: '</span> <span class="op">+</span> <span class="bu">str</span>(channelcount) <span class="op">+</span> <span class="st">' labelled: '</span> <span class="op">+</span> <span class="bu">str</span>(channel_labels) <span class="op">+</span> <span class="st">' and a sampling rate of '</span> <span class="op">+</span> <span class="bu">str</span>(samplerate))        </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Clipping all streams based on the start and end times</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Clipping all streams based on the start and end times'</span>)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (start_event, end_event), (start_time, end_time) <span class="kw">in</span> start_end_times.items():</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Clipping based on event pair: </span><span class="sc">{</span>start_event<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>end_event<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Start time: </span><span class="sc">{</span>start_time<span class="sc">}</span><span class="ss">, End time: </span><span class="sc">{</span>end_time<span class="sc">}</span><span class="ss">"</span>)<span class="op">\</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check if the start and end times are within the range of the timevec</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> start_time <span class="op">&lt;</span> <span class="bu">min</span>(timevec) <span class="kw">or</span> end_time <span class="op">&gt;</span> <span class="bu">max</span>(timevec):</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"ERROR: The specified start or end time is outside the range of the time vector."</span>)</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Find the index of the closest timestamp to the start and end times</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>            start_idx <span class="op">=</span> np.searchsorted(timevec, start_time, side<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>            end_idx   <span class="op">=</span> np.searchsorted(timevec, end_time, side<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>             <span class="co"># Clip the timevec and timeseries based on the start and end indices</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>            clipped_timevec <span class="op">=</span> timevec[start_idx:end_idx]</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>            clipped_timeseries <span class="op">=</span> timeseries[start_idx:end_idx]</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('start time :'  + str(min(clipped_timevec)))</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('end time: '    + str(max(clipped_timevec)))</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>            <span class="co">## SAVING THE CLIPPED DATA AS A CSV FILE</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Create a csv compatable matrix from the clipped timevec and timeseries (with column names)</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>            matrix_aux <span class="op">=</span> np.vstack([np.transpose(clipped_timevec), np.transpose(clipped_timeseries)])  <span class="co"># Create matrix_aux by concatenating the transposed clipped_timevec and clipped_timeseries</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>            matrix <span class="op">=</span> np.transpose(matrix_aux)  <span class="co"># Create new matrix by tranposing matrix_aux</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>            column_names <span class="op">=</span> [<span class="st">"LSL_Time"</span>] <span class="op">+</span> [<span class="ss">f"</span><span class="sc">{</span>timeseries_name<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> label <span class="kw">in</span> channel_labels]</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>            df_clipped <span class="op">=</span> pd.DataFrame(matrix, columns<span class="op">=</span>column_names)  <span class="co"># Create a DataFrame df_clipped with the combined data and the appropriate column names</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Saving this matrix as a csv file</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>            subfolder_path <span class="op">=</span> os.path.join(output_folder, fnam.split(<span class="st">'_'</span>)[<span class="dv">0</span>], method)    <span class="co"># Create the subfolder path</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>            file_name <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>fnam<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>timeseries_name<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>start_event<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>end_event<span class="sc">}</span><span class="ss">'</span>       <span class="co"># Create the file name</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>            os.makedirs(subfolder_path, exist_ok<span class="op">=</span><span class="va">True</span>)                                  <span class="co"># Create the subfolder if it doesn't exist</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>            df_clipped.to_csv(os.path.join(subfolder_path, <span class="ss">f'</span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">.csv'</span>), index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Saving: '</span> <span class="op">+</span> fnam <span class="op">+</span> <span class="st">'_'</span> <span class="op">+</span> file_name <span class="op">+</span> <span class="st">" in folder "</span> <span class="op">+</span> subfolder_path) </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>            <span class="co">## CREATING A WAV FILE FOR THE MICROPHONE STREAM</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">"Mic"</span> <span class="kw">in</span> timeseries_name:  <span class="co"># Check if the data stream is from a microphone</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'Creating a WAV file for the microphone stream'</span>)</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>                subfolder_path_wav <span class="op">=</span> os.path.join(subfolder_path, <span class="ss">f'</span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">.wav'</span>)   <span class="co"># Define the location to save the initial audio file</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Normalize the file path to avoid mixed path separators</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>                subfolder_path_wav <span class="op">=</span> os.path.normpath(subfolder_path_wav)</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>                to_audio(subfolder_path_wav, timeseries_name, clipped_timeseries)        <span class="co"># Convert the time series data to an audio file and save it at the defined location</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>                rate, data <span class="op">=</span> wavfile.read(subfolder_path_wav)                           <span class="co"># Load the audio data from the saved WAV file</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>                reduced_noise <span class="op">=</span> nr.reduce_noise(y<span class="op">=</span>data, sr<span class="op">=</span>rate, n_std_thresh_stationary<span class="op">=</span>noise_reducelevel, stationary<span class="op">=</span><span class="va">True</span>)    <span class="co"># Perform noise reduction based on the noise_reducelevel </span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>                subfolder_path_wav_2 <span class="op">=</span> os.path.join(subfolder_path, <span class="ss">f'</span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">_denoised.wav'</span>)</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Normalize the path for the denoised file</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>                subfolder_path_wav_2 <span class="op">=</span> os.path.normpath(subfolder_path_wav_2)</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>                wavfile.write(subfolder_path_wav_2, rate, reduced_noise)                                                        <span class="co"># Save the noise-reduced audio data as a new WAV file at the defined location</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Done with extracting all the streams! You can now look into your folder: "</span> <span class="op">+</span> output_folder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Output folder = f:\Mobile-Multimodal-Lab\2_PREPROCESSING\1_XDF_PROCESSING\data_processed
loading xdf file: F:/Mobile-Multimodal-Lab/2_PREPROCESSING/XDF_PROCESSING/data_raw/T1_experiment.xdf
Renaming streams based on the dictionary mapping
Renaming stream MyWebcamFrameStream_2 (frameNR) to Video_P2
Renaming stream MyWebcamFrameStream_1 (frameNR) to Video_P1
Renaming stream OpenSignals (00:07:80:8C:06:6A) to PLUX_P2
Renaming stream OpenSignals (00:07:80:D8:A8:81) to PLUX_P1
Renaming stream Mic (voice) to Mic_P1
Renaming stream Mic_004 (voice) to Mic_P2
Finding the start and end times for all streams in the XDF file
Marker stream: 
NoVision_NoMovement_0_StartTrial
NoVision_NoMovement_0_StartAudioPresentation
NoVision_NoMovement_0_StartAudioPresentation
NoVision_NoMovement_0_StartParticipantSinging
NoVision_NoMovement_0_EndParticipantSinging
NoVision_NoMovement_1_StartTrial
NoVision_NoMovement_1_StartAudioPresentation
NoVision_NoMovement_1_StartAudioPresentation
NoVision_NoMovement_1_StartParticipantSinging
NoVision_NoMovement_1_EndParticipantSinging
NoVision_NoMovement_2_StartTrial
NoVision_NoMovement_2_StartAudioPresentation
NoVision_NoMovement_2_StartAudioPresentation
NoVision_NoMovement_2_StartParticipantSinging
NoVision_NoMovement_2_EndParticipantSinging
NoVision_NoMovement_3_StartTrial
NoVision_NoMovement_3_StartAudioPresentation
NoVision_NoMovement_3_StartAudioPresentation
NoVision_NoMovement_3_StartParticipantSinging
NoVision_NoMovement_3_EndParticipantSinging
NoVision_NoMovement_4_StartTrial
NoVision_NoMovement_4_StartAudioPresentation
NoVision_NoMovement_4_StartAudioPresentation
NoVision_NoMovement_4_StartParticipantSinging
NoVision_NoMovement_4_EndParticipantSinging
NoVision_Movement_0_StartTrial
NoVision_Movement_0_StartAudioPresentation
NoVision_Movement_0_StartAudioPresentation
NoVision_Movement_0_StartParticipantSinging
NoVision_Movement_0_EndParticipantSinging
NoVision_Movement_1_StartTrial
NoVision_Movement_1_StartAudioPresentation
NoVision_Movement_1_StartAudioPresentation
NoVision_Movement_1_StartParticipantSinging
NoVision_Movement_1_EndParticipantSinging
NoVision_Movement_2_StartTrial
NoVision_Movement_2_StartAudioPresentation
NoVision_Movement_2_StartAudioPresentation
NoVision_Movement_2_StartParticipantSinging
NoVision_Movement_2_EndParticipantSinging
NoVision_Movement_3_StartTrial
NoVision_Movement_3_StartAudioPresentation
NoVision_Movement_3_StartAudioPresentation
NoVision_Movement_3_StartParticipantSinging
NoVision_Movement_3_EndParticipantSinging
NoVision_Movement_4_StartTrial
NoVision_Movement_4_StartAudioPresentation
NoVision_Movement_4_StartAudioPresentation
NoVision_Movement_4_StartParticipantSinging
NoVision_Movement_4_EndParticipantSinging
Vision_NoMovement_0_StartTrial
Vision_NoMovement_0_StartAudioPresentation
Vision_NoMovement_0_StartAudioPresentation
Vision_NoMovement_0_StartParticipantSinging
Vision_NoMovement_0_EndParticipantSinging
Vision_NoMovement_1_StartTrial
Vision_NoMovement_1_StartAudioPresentation
Vision_NoMovement_1_StartAudioPresentation
Vision_NoMovement_1_StartParticipantSinging
Vision_NoMovement_1_EndParticipantSinging
Vision_NoMovement_2_StartTrial
Vision_NoMovement_2_StartAudioPresentation
Vision_NoMovement_2_StartAudioPresentation
Vision_NoMovement_2_StartParticipantSinging
Vision_NoMovement_2_EndParticipantSinging
Vision_NoMovement_3_StartTrial
Vision_NoMovement_3_StartAudioPresentation
Vision_NoMovement_3_StartAudioPresentation
Vision_NoMovement_3_StartParticipantSinging
Vision_NoMovement_3_EndParticipantSinging
Vision_NoMovement_4_StartTrial
Vision_NoMovement_4_StartAudioPresentation
Vision_NoMovement_4_StartAudioPresentation
Vision_NoMovement_4_StartParticipantSinging
Vision_NoMovement_4_EndParticipantSinging
Vision_Movement_0_StartTrial
Vision_Movement_0_StartAudioPresentation
Vision_Movement_0_StartAudioPresentation
Vision_Movement_0_StartParticipantSinging
Vision_Movement_0_EndParticipantSinging
Vision_Movement_1_StartTrial
Vision_Movement_1_StartAudioPresentation
Vision_Movement_1_StartAudioPresentation
Vision_Movement_1_StartParticipantSinging
Vision_Movement_1_EndParticipantSinging
Vision_Movement_2_StartTrial
Vision_Movement_2_StartAudioPresentation
Vision_Movement_2_StartAudioPresentation
Vision_Movement_2_StartParticipantSinging
Vision_Movement_2_EndParticipantSinging
Vision_Movement_3_StartTrial
Vision_Movement_3_StartAudioPresentation
Vision_Movement_3_StartAudioPresentation
Vision_Movement_3_StartParticipantSinging
Vision_Movement_3_EndParticipantSinging
Vision_Movement_4_StartTrial
Vision_Movement_4_StartAudioPresentation
Vision_Movement_4_StartAudioPresentation
Vision_Movement_4_StartParticipantSinging
Vision_Movement_4_EndParticipantSinging
Method: marker_MULTIPLEpairs
Selected START &amp; END Event Pairs: [['NoVision_NoMovement_0_StartParticipantSinging', 'NoVision_NoMovement_0_EndParticipantSinging'], ['NoVision_NoMovement_1_StartParticipantSinging', 'NoVision_NoMovement_1_EndParticipantSinging'], ['NoVision_NoMovement_2_StartParticipantSinging', 'NoVision_NoMovement_2_EndParticipantSinging'], ['NoVision_NoMovement_3_StartParticipantSinging', 'NoVision_NoMovement_3_EndParticipantSinging'], ['NoVision_NoMovement_4_StartParticipantSinging', 'NoVision_NoMovement_4_EndParticipantSinging'], ['NoVision_Movement_0_StartParticipantSinging', 'NoVision_Movement_0_EndParticipantSinging'], ['NoVision_Movement_1_StartParticipantSinging', 'NoVision_Movement_1_EndParticipantSinging'], ['NoVision_Movement_2_StartParticipantSinging', 'NoVision_Movement_2_EndParticipantSinging'], ['NoVision_Movement_3_StartParticipantSinging', 'NoVision_Movement_3_EndParticipantSinging'], ['NoVision_Movement_4_StartParticipantSinging', 'NoVision_Movement_4_EndParticipantSinging'], ['Vision_NoMovement_0_StartParticipantSinging', 'Vision_NoMovement_0_EndParticipantSinging'], ['Vision_NoMovement_1_StartParticipantSinging', 'Vision_NoMovement_1_EndParticipantSinging'], ['Vision_NoMovement_2_StartParticipantSinging', 'Vision_NoMovement_2_EndParticipantSinging'], ['Vision_NoMovement_3_StartParticipantSinging', 'Vision_NoMovement_3_EndParticipantSinging'], ['Vision_NoMovement_4_StartParticipantSinging', 'Vision_NoMovement_4_EndParticipantSinging'], ['Vision_Movement_0_StartParticipantSinging', 'Vision_Movement_0_EndParticipantSinging'], ['Vision_Movement_1_StartParticipantSinging', 'Vision_Movement_1_EndParticipantSinging'], ['Vision_Movement_2_StartParticipantSinging', 'Vision_Movement_2_EndParticipantSinging'], ['Vision_Movement_3_StartParticipantSinging', 'Vision_Movement_3_EndParticipantSinging'], ['Vision_Movement_4_StartParticipantSinging', 'Vision_Movement_4_EndParticipantSinging']]
Selected START &amp; END Time Pairs : {('NoVision_NoMovement_0_StartParticipantSinging', 'NoVision_NoMovement_0_EndParticipantSinging'): (6384.806083203646, 6397.013036191298), ('NoVision_NoMovement_1_StartParticipantSinging', 'NoVision_NoMovement_1_EndParticipantSinging'): (6416.870787229756, 6429.077814017222), ('NoVision_NoMovement_2_StartParticipantSinging', 'NoVision_NoMovement_2_EndParticipantSinging'): (6448.942472338304, 6461.150119924207), ('NoVision_NoMovement_3_StartParticipantSinging', 'NoVision_NoMovement_3_EndParticipantSinging'): (6481.0053666689655, 6493.211191459455), ('NoVision_NoMovement_4_StartParticipantSinging', 'NoVision_NoMovement_4_EndParticipantSinging'): (6513.058285124728, 6525.268648603798), ('NoVision_Movement_0_StartParticipantSinging', 'NoVision_Movement_0_EndParticipantSinging'): (6572.677811323683, 6584.89003219808), ('NoVision_Movement_1_StartParticipantSinging', 'NoVision_Movement_1_EndParticipantSinging'): (6604.757449812219, 6616.965000998366), ('NoVision_Movement_2_StartParticipantSinging', 'NoVision_Movement_2_EndParticipantSinging'): (6636.81911644597, 6649.0337567142815), ('NoVision_Movement_3_StartParticipantSinging', 'NoVision_Movement_3_EndParticipantSinging'): (6668.8948338443715, 6681.1021446311215), ('NoVision_Movement_4_StartParticipantSinging', 'NoVision_Movement_4_EndParticipantSinging'): (6700.955760479987, 6713.162611767893), ('Vision_NoMovement_0_StartParticipantSinging', 'Vision_NoMovement_0_EndParticipantSinging'): (6740.493335904561, 6752.700019392892), ('Vision_NoMovement_1_StartParticipantSinging', 'Vision_NoMovement_1_EndParticipantSinging'): (6772.556007635785, 6784.768685509032), ('Vision_NoMovement_2_StartParticipantSinging', 'Vision_NoMovement_2_EndParticipantSinging'): (6804.623555954739, 6816.827725649393), ('Vision_NoMovement_3_StartParticipantSinging', 'Vision_NoMovement_3_EndParticipantSinging'): (6836.676878809483, 6848.89254587521), ('Vision_NoMovement_4_StartParticipantSinging', 'Vision_NoMovement_4_EndParticipantSinging'): (6868.734037254579, 6880.938031349673), ('Vision_Movement_0_StartParticipantSinging', 'Vision_Movement_0_EndParticipantSinging'): (6906.09814004755, 6918.305940933068), ('Vision_Movement_1_StartParticipantSinging', 'Vision_Movement_1_EndParticipantSinging'): (6938.156116590586, 6950.365261572723), ('Vision_Movement_2_StartParticipantSinging', 'Vision_Movement_2_EndParticipantSinging'): (6970.222884311505, 6982.430652197105), ('Vision_Movement_3_StartParticipantSinging', 'Vision_Movement_3_EndParticipantSinging'): (7002.290225630978, 7014.495512522822), ('Vision_Movement_4_StartParticipantSinging', 'Vision_Movement_4_EndParticipantSinging'): (7034.349694470262, 7046.5529955671)}
working on stream: AudioEvents  with a channel count of: 1 labelled: ['Channel 1'] and a sampling rate of 0
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_AudioEvents_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_AudioEvents_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


working on stream: Video_P2  with a channel count of: 1 labelled: ['Channel 1'] and a sampling rate of 500
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_Video_P2_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_Video_P2_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_Video_P2_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_Video_P2_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_Video_P2_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_Video_P2_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_Video_P2_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_Video_P2_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_Video_P2_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_Video_P2_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_Video_P2_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


working on stream: Video_P1  with a channel count of: 1 labelled: ['Channel 1'] and a sampling rate of 500
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_Video_P1_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_Video_P1_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_Video_P1_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_Video_P1_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_Video_P1_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_Video_P1_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_Video_P1_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_Video_P1_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_Video_P1_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_Video_P1_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_Video_P1_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


working on stream: PLUX_P2  with a channel count of: 5 labelled: ['nSeq', 'ECG0', 'EMG1', 'EMG2', 'RIP3'] and a sampling rate of 1000
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_PLUX_P2_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_PLUX_P2_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


working on stream: PLUX_P1  with a channel count of: 5 labelled: ['nSeq', 'ECG0', 'EMG1', 'EMG2', 'RESPIRATION3'] and a sampling rate of 1000
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_PLUX_P1_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_PLUX_P1_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs


working on stream: Mic_P1  with a channel count of: 1 labelled: ['Channel 1'] and a sampling rate of 16000
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_Mic_P1_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_Mic_P1_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


working on stream: Mic_P2  with a channel count of: 1 labelled: ['Channel 1'] and a sampling rate of 16000
Clipping all streams based on the start and end times
Clipping based on event pair: NoVision_NoMovement_0_StartParticipantSinging - NoVision_NoMovement_0_EndParticipantSinging
Start time: 6384.806083203646, End time: 6397.013036191298
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_NoMovement_0_StartParticipantSinging_NoVision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_1_StartParticipantSinging - NoVision_NoMovement_1_EndParticipantSinging
Start time: 6416.870787229756, End time: 6429.077814017222
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_NoMovement_1_StartParticipantSinging_NoVision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_2_StartParticipantSinging - NoVision_NoMovement_2_EndParticipantSinging
Start time: 6448.942472338304, End time: 6461.150119924207
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_NoMovement_2_StartParticipantSinging_NoVision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_3_StartParticipantSinging - NoVision_NoMovement_3_EndParticipantSinging
Start time: 6481.0053666689655, End time: 6493.211191459455
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_NoMovement_3_StartParticipantSinging_NoVision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_NoMovement_4_StartParticipantSinging - NoVision_NoMovement_4_EndParticipantSinging
Start time: 6513.058285124728, End time: 6525.268648603798
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_NoMovement_4_StartParticipantSinging_NoVision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_0_StartParticipantSinging - NoVision_Movement_0_EndParticipantSinging
Start time: 6572.677811323683, End time: 6584.89003219808
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_Movement_0_StartParticipantSinging_NoVision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_1_StartParticipantSinging - NoVision_Movement_1_EndParticipantSinging
Start time: 6604.757449812219, End time: 6616.965000998366
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_Movement_1_StartParticipantSinging_NoVision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_2_StartParticipantSinging - NoVision_Movement_2_EndParticipantSinging
Start time: 6636.81911644597, End time: 6649.0337567142815
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_Movement_2_StartParticipantSinging_NoVision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_3_StartParticipantSinging - NoVision_Movement_3_EndParticipantSinging
Start time: 6668.8948338443715, End time: 6681.1021446311215
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_Movement_3_StartParticipantSinging_NoVision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: NoVision_Movement_4_StartParticipantSinging - NoVision_Movement_4_EndParticipantSinging
Start time: 6700.955760479987, End time: 6713.162611767893
Saving: T1_experiment_T1_experiment_Mic_P2_NoVision_Movement_4_StartParticipantSinging_NoVision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_0_StartParticipantSinging - Vision_NoMovement_0_EndParticipantSinging
Start time: 6740.493335904561, End time: 6752.700019392892
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_NoMovement_0_StartParticipantSinging_Vision_NoMovement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_1_StartParticipantSinging - Vision_NoMovement_1_EndParticipantSinging
Start time: 6772.556007635785, End time: 6784.768685509032
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_NoMovement_1_StartParticipantSinging_Vision_NoMovement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_2_StartParticipantSinging - Vision_NoMovement_2_EndParticipantSinging
Start time: 6804.623555954739, End time: 6816.827725649393
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_NoMovement_2_StartParticipantSinging_Vision_NoMovement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_3_StartParticipantSinging - Vision_NoMovement_3_EndParticipantSinging
Start time: 6836.676878809483, End time: 6848.89254587521
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_NoMovement_3_StartParticipantSinging_Vision_NoMovement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_NoMovement_4_StartParticipantSinging - Vision_NoMovement_4_EndParticipantSinging
Start time: 6868.734037254579, End time: 6880.938031349673
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_NoMovement_4_StartParticipantSinging_Vision_NoMovement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_0_StartParticipantSinging - Vision_Movement_0_EndParticipantSinging
Start time: 6906.09814004755, End time: 6918.305940933068
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_Movement_0_StartParticipantSinging_Vision_Movement_0_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_1_StartParticipantSinging - Vision_Movement_1_EndParticipantSinging
Start time: 6938.156116590586, End time: 6950.365261572723
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_Movement_1_StartParticipantSinging_Vision_Movement_1_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_2_StartParticipantSinging - Vision_Movement_2_EndParticipantSinging
Start time: 6970.222884311505, End time: 6982.430652197105
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_Movement_2_StartParticipantSinging_Vision_Movement_2_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_3_StartParticipantSinging - Vision_Movement_3_EndParticipantSinging
Start time: 7002.290225630978, End time: 7014.495512522822
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_Movement_3_StartParticipantSinging_Vision_Movement_3_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Clipping based on event pair: Vision_Movement_4_StartParticipantSinging - Vision_Movement_4_EndParticipantSinging
Start time: 7034.349694470262, End time: 7046.5529955671
Saving: T1_experiment_T1_experiment_Mic_P2_Vision_Movement_4_StartParticipantSinging_Vision_Movement_4_EndParticipantSinging in folder ./data_processed/T1\marker_MULTIPLEpairs
Creating a WAV file for the microphone stream


Done with extracting all the streams! You can now look into your folder: ./data_processed/</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>